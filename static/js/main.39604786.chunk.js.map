{"version":3,"sources":["SettingsMode.tsx","ExerciseMode.tsx","App.tsx","index.tsx"],"names":["range","start","end","Array","fill","map","_","index","SettingsMode","props","className","defaultValue","totalReps","onChange","event","onTotalRepsChange","Number","target","value","toString","secsPerRep","onSecsPerRepChange","onClick","onExerciseStart","ExerciseMode","exercises","useState","currentExerciseIndex","setCurrentExerciseIndex","currentRep","setCurrentRep","millisecondsLeft","setMillisecondsLeft","isBlinking","setIsBlinking","isPaused","setIsPaused","updateCurrentRep","newCurrentRep","newCurrentExerciseIndex","length","updateCurrentExercise","Date","now","lastUpdate","setLastUpdate","useEffect","timeoutId","setTimeout","delta","newMillisecondsLeft","Math","max","updateMillisecondsLeft","clearTimeout","ceil","onExerciseStop","App","mode","setMode","anyNavigator","navigator","wakeLock","request","then","catch","setTotalReps","setSecsPerRep","getMode","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.39604786.chunk.js","sourcesContent":["import React, { Dispatch, SetStateAction } from 'react';\nimport './SettingsMode.css';\n\ntype SettingsModeProps = {\n  totalReps: number,\n  onTotalRepsChange: Dispatch<SetStateAction<number>>,\n  secsPerRep: number,\n  onSecsPerRepChange: Dispatch<SetStateAction<number>>,\n  onExerciseStart: () => void,\n};\n\nfunction SettingsMode(props: SettingsModeProps) {\n  return (\n    <div className=\"SettingsMode flex-column\">\n      <p className=\"heading\">Repetitions:</p>\n      <select defaultValue={props.totalReps} onChange={(event) => props.onTotalRepsChange(Number(event.target.value))}>\n        {range(3, 21).map((value) => (\n          <option\n            key={value}\n            value={value.toString()}\n          >\n            {value}\n          </option>\n        ))}\n      </select>\n      <p className=\"heading\">Seconds:</p>\n      <select defaultValue={props.secsPerRep} onChange={(event) => props.onSecsPerRepChange(Number(event.target.value))}>\n        {range(1, 13).map((value) => (\n          <option\n            key={value}\n            value={value.toString()}\n          >\n            {value}\n          </option>\n        ))}\n      </select>\n      <button onClick={props.onExerciseStart}>Start</button>\n    </div>\n  );\n}\n\nfunction range(start: number, end: number) {\n  return new Array(end - start).fill(null).map((_, index) => start + index);\n}\n\nexport default SettingsMode;\n","import React, { useEffect, useState } from 'react';\n\ntype ExerciseModeProps = {\n  totalReps: number,\n  secsPerRep: number,\n  onExerciseStop: () => void,\n};\n\nfunction ExerciseMode(props: ExerciseModeProps) {\n  const exercises = [\n    \"Растяжение боковых мышц шеи\",\n    \"Разгибание шеи\",\n    \"Сгибание и разгибание шеи\",\n    \"Сгибание шеи\",\n    \"Растяжение шеи\",\n    \"Повороты шеи\",\n    \"Потягивание\",\n    \"Боковое сгибание\",\n    \"Повороты в сторону\",\n    \"Сгибание\",\n  ];\n\n  const [currentExerciseIndex, setCurrentExerciseIndex] = useState(0);\n  const [currentRep, setCurrentRep] = useState(1);\n  const [millisecondsLeft, setMillisecondsLeft] = useState(props.secsPerRep * 1000);\n\n  const [isBlinking, setIsBlinking] = useState(false);\n\n  const [isPaused, setIsPaused] = useState(true);\n\n  const updateCurrentExercise = () => {\n    const newCurrentExerciseIndex = currentExerciseIndex + 1;\n        \n    if (newCurrentExerciseIndex === exercises.length) {\n      setIsPaused(true);\n      setCurrentExerciseIndex(0);\n    } else {\n      setCurrentExerciseIndex(newCurrentExerciseIndex);\n    }\n  };\n\n  const updateCurrentRep = () => {\n    const newCurrentRep = currentRep + 1;\n\n    if (newCurrentRep === props.totalReps + 1) {\n      setCurrentRep(1);\n      updateCurrentExercise();\n    } else {\n      setCurrentRep(newCurrentRep);\n    }\n  };\n\n  const updateMillisecondsLeft = (delta: number) => {\n    const newMillisecondsLeft = Math.max(0, millisecondsLeft - delta);\n\n    if (newMillisecondsLeft === 0) {\n      setMillisecondsLeft(props.secsPerRep * 1000);\n      setIsBlinking(true);\n      updateCurrentRep();\n    } else {\n      setIsBlinking(false);\n      setMillisecondsLeft(newMillisecondsLeft);\n    }\n  };\n\n  const [lastUpdate, setLastUpdate] = useState(Date.now());\n  useEffect(() => {\n    if (isPaused) {\n      return;\n    }\n\n    const precision = 200;\n    const timeoutId = setTimeout(() => {\n      setLastUpdate(Date.now());\n      updateMillisecondsLeft(precision);\n    }, precision - (Date.now() - lastUpdate));\n\n    return () => {\n      clearTimeout(timeoutId);\n    };\n  });\n\n  const getPauseModeControls = () => (\n    <>\n      <button onClick={() => setIsPaused(false)}>Resume</button>\n      <button onClick={props.onExerciseStop}>Return to menu</button>\n    </>\n  );\n  \n  return (\n    <div className={`SettingsMode flex-column ${isBlinking ? 'blinking' : ''}`}>\n      <p className=\"heading\">Exercise:</p>\n      <p className=\"heading\">{exercises[currentExerciseIndex]}</p>\n      <p className=\"heading\">Repetition:</p>\n      <p className=\"heading\">{currentRep} / {props.totalReps}</p>\n      <p className=\"heading\">Seconds left:</p>\n      <p className=\"heading\">{Math.ceil(millisecondsLeft / 1000)} / {props.secsPerRep}</p>\n      {isPaused ? getPauseModeControls() : <button onClick={() => setIsPaused(true)}>Pause</button>}\n    </div>\n  );\n}\n\nexport default ExerciseMode;\n","import React, { useEffect, useState } from 'react';\nimport './App.css';\n\nimport SettingsMode from './SettingsMode';\nimport ExerciseMode from './ExerciseMode';\n\nfunction App() {\n  const [mode, setMode] = useState<'exercise' | 'settings' | 'no-wake-lock'>('settings');\n\n  useEffect(() => {\n    // Navigator types are hopelessly outdated\n    const anyNavigator = navigator as any;\n    if (!('wakeLock' in anyNavigator)) {\n      setMode('no-wake-lock');\n      return;\n    }\n\n    anyNavigator.wakeLock.request('screen')\n      .then(() => setMode('settings'))\n      .catch(() => setMode('no-wake-lock'));\n  }, []);\n\n  const [totalReps, setTotalReps] = useState(10);\n  const [secsPerRep, setSecsPerRep] = useState(10);\n\n  const getSettingsMode = () => (\n    <SettingsMode\n      totalReps={totalReps}\n      onTotalRepsChange={setTotalReps}\n      secsPerRep={secsPerRep}\n      onSecsPerRepChange={setSecsPerRep}\n      onExerciseStart={() => setMode('exercise')}\n    />\n  );\n\n  const getExerciseMode = () => (\n    <ExerciseMode\n      totalReps={totalReps}\n      secsPerRep={secsPerRep}\n      onExerciseStop={() => setMode('settings')}\n    />\n  );\n\n  const getMode = () => {\n    switch (mode) {\n      case 'settings': return getSettingsMode();\n      case 'exercise': return getExerciseMode();\n      case 'no-wake-lock': return <div className=\"flex-column\">Failed to aquire wake lock. Try to reload your page</div>;\n    }\n  };\n\n  return (\n    <div className=\"App\">\n      {getMode()}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}